DROP TABLE IF EXISTS TOKENS;
DROP TABLE IF EXISTS USER_ROLES;
DROP TABLE IF EXISTS USERS;

CREATE TABLE USERS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    LOGIN VARCHAR(255) NOT NULL UNIQUE,
    PASSWORD VARCHAR(255) NOT NULL,
    EMAIL VARCHAR(255) NOT NULL UNIQUE
);

CREATE TABLE TOKENS
(
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    USER_ID BIGINT NOT NULL ,
    TOKEN VARCHAR(255) NOT NULL,
    EXPIRED_AT TIMESTAMP NOT NULL
);

CREATE TABLE USER_ROLES
(
    USER_ID BIGINT NOT NULL ,
    ROLE VARCHAR(255) NOT NULL
);

ALTER TABLE IF EXISTS TOKENS
    ADD CONSTRAINT TOKENS_USERS_fk FOREIGN KEY (USER_ID) REFERENCES users;
ALTER TABLE IF EXISTS USER_ROLES
    ADD CONSTRAINT ROLES_USERS_fk FOREIGN KEY (USER_ID) REFERENCES users;